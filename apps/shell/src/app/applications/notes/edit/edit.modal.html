<div mat-dialog-content class="dialog-content" [formGroup]="noteForm">
  <mat-form-field class="title-field">
    <input
      matInput
      placeholder="Title"
      class="title-input"
      formControlName="title">
  </mat-form-field>
  <mat-form-field class="note-field">
      <textarea
        matInput
        cdkTextareaAutosize
        placeholder="Note"
        class="note-textarea"
        formControlName="content"></textarea>
  </mat-form-field>

  <mat-chip-listbox multiple aria-label="Label selection">
    @for(label of allLabels(); track label.id) {
      <mat-chip-option
        [selected]="isLabelSelected(label)"
        (click)="toggleLabel(label)">
        {{ label.name }}
      </mat-chip-option>
    }
  </mat-chip-listbox>

  <div class="bg-surface-container-lowest rounded-full mt-5 flex items-center shadow-xs p-3">
    <mf-brand-colors [colors]="allColors()"
                      formControlName="color"
                      withGradient/>
  </div>

  <div class="tasks-section" formArrayName="tasks">
    @if (tasksArray.controls.length > 0) {
      @for(taskControl of tasksArray.controls; track $index) {
        <div class="task-row" [formGroupName]="$index">
          <mat-checkbox formControlName="completed"></mat-checkbox>
          <div class="task-input-field">
            <input formControlName="content" [class.completed]="taskControl.value.completed">
          </div>
          <button mat-icon-button (click)="removeTask($index)">
            <mat-icon>close</mat-icon>
          </button>
        </div>
      }
    }

    <div class="add-task-row">
      <mat-icon>add</mat-icon>
      <input
        #newTaskInput
        placeholder="Add task"
        (keydown.enter)="addTask(newTaskInput.value)"
      />
    </div>
  </div>
</div>
<div mat-dialog-actions class="dialog-actions">
  <div class="left-actions">
    <button mat-icon-button aria-label="Add image"><mat-icon>image</mat-icon></button>
    <button mat-icon-button aria-label="Archive"><mat-icon>archive</mat-icon></button>
    <button mat-icon-button aria-label="Star"><mat-icon>star</mat-icon></button>
  </div>
  <div class="right-actions">
    <button mat-button (click)="close()">Cancel</button>
    <button mat-flat-button (click)="save()" [disabled]="noteForm.invalid">Save</button>
  </div>
</div>
