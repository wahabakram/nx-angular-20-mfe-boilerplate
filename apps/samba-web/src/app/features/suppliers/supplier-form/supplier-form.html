<mf-panel>
  <mf-panel-header class="h-16">
    <div class="flex h-full border-b border-b-surface-container items-center justify-between gap-5 px-6">
      <div class="flex items-center gap-3">
        <a mat-icon-button routerLink="/suppliers">
          <mf-icon name="solar:arrow-left-line-duotone" />
        </a>
        <div class="text-lg font-semibold">
          {{ isEditMode() ? 'Edit Supplier' : 'New Supplier' }}
        </div>
      </div>
      <div class="flex items-center gap-4">
        <button mat-button routerLink="/suppliers" [disabled]="isLoading()">
          Cancel
        </button>
        <button mat-flat-button color="primary" (click)="onSubmit()" [disabled]="isLoading() || supplierForm.invalid">
          @if (isLoading()) {
            <mat-spinner diameter="20" class="mr-2"></mat-spinner>
          }
          {{ isEditMode() ? 'Update Supplier' : 'Create Supplier' }}
        </button>
      </div>
    </div>
  </mf-panel-header>

  <mf-panel-body>
    <mf-overlay-scrollbar [absolute]="true">
        <div class="p-7 lg:w-[800px] lg:mx-auto">
          @if (error()) {
            <div class="mb-6 p-4 bg-error-50 dark:bg-error-900/20 text-error border-l-4 border-error rounded-r">
              <div class="flex items-center">
                <mf-icon class="mr-2" name="solar:danger-circle-line-duotone" />
                <span>{{ error() }}</span>
              </div>
            </div>
          }

          <form [formGroup]="supplierForm" class="flex flex-col gap-6">
            <!-- Basic Information -->
            <section class="card-container px-6 py-6 pb-1">
              <header class="flex items-center gap-3">
                <div class="size-11 rounded-lg flex items-center justify-center bg-primary-200 dark:bg-primary-900/30">
                  <mf-icon name="solar:shop-2-line-duotone" />
                </div>
                <div class="font-semibold">Basic Information</div>
              </header>

              <div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-4">
                <mat-form-field class="w-full">
                  <mat-label>Supplier Name</mat-label>
                  <input matInput formControlName="name" required>
                  @if (supplierForm.get('name')?.invalid && supplierForm.get('name')?.touched) {
                    <mat-error>{{ getErrorMessage('name') }}</mat-error>
                  }
                </mat-form-field>

                <mat-form-field class="w-full">
                  <mat-label>Company Name</mat-label>
                  <input matInput formControlName="companyName" placeholder="Optional">
                </mat-form-field>

                <mat-form-field class="w-full">
                  <mat-label>Phone</mat-label>
                  <input matInput formControlName="phone" required>
                  @if (supplierForm.get('phone')?.invalid && supplierForm.get('phone')?.touched) {
                    <mat-error>{{ getErrorMessage('phone') }}</mat-error>
                  }
                </mat-form-field>

                <mat-form-field class="w-full">
                  <mat-label>Email</mat-label>
                  <input matInput formControlName="email" type="email" placeholder="Optional">
                  @if (supplierForm.get('email')?.invalid && supplierForm.get('email')?.touched) {
                    <mat-error>{{ getErrorMessage('email') }}</mat-error>
                  }
                </mat-form-field>

                <mat-form-field class="w-full">
                  <mat-label>Status</mat-label>
                  <mat-select formControlName="status" required>
                    @for (status of statuses; track status) {
                      <mat-option [value]="status">{{ status | titlecase }}</mat-option>
                    }
                  </mat-select>
                </mat-form-field>
              </div>
            </section>

            <!-- Address Information -->
            <section class="card-container px-6 py-6 pb-1">
              <header class="flex items-center gap-3">
                <div class="size-11 rounded-lg flex items-center justify-center bg-blue-200 dark:bg-blue-900/30">
                  <mf-icon name="solar:map-point-line-duotone" />
                </div>
                <div class="font-semibold">Address Information</div>
              </header>

              <div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-4">
                <mat-form-field class="w-full md:col-span-2">
                  <mat-label>Address</mat-label>
                  <input matInput formControlName="address" placeholder="Optional">
                </mat-form-field>

                <mat-form-field class="w-full">
                  <mat-label>City</mat-label>
                  <input matInput formControlName="city" placeholder="Optional">
                </mat-form-field>

                <mat-form-field class="w-full">
                  <mat-label>Country</mat-label>
                  <input matInput formControlName="country" placeholder="Optional">
                </mat-form-field>

                <mat-form-field class="w-full">
                  <mat-label>Tax ID</mat-label>
                  <input matInput formControlName="taxId" placeholder="Optional">
                </mat-form-field>
              </div>
            </section>

            <!-- Financial Information -->
            <section class="card-container px-6 py-6 pb-1">
              <header class="flex items-center gap-3">
                <div class="size-11 rounded-lg flex items-center justify-center bg-green-200 dark:bg-green-900/30">
                  <mf-icon name="solar:dollar-line-duotone" />
                </div>
                <div class="font-semibold">Financial Information</div>
              </header>

              <div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-4">
                <mat-form-field class="w-full">
                  <mat-label>Payment Terms</mat-label>
                  <input matInput formControlName="paymentTerms" placeholder="e.g., Net 30, Net 60">
                </mat-form-field>

                <mat-form-field class="w-full">
                  <mat-label>Credit Limit</mat-label>
                  <input matInput formControlName="creditLimit" type="number" min="0" placeholder="0">
                  <span matTextSuffix>USD</span>
                  @if (supplierForm.get('creditLimit')?.invalid && supplierForm.get('creditLimit')?.touched) {
                    <mat-error>{{ getErrorMessage('creditLimit') }}</mat-error>
                  }
                </mat-form-field>
              </div>
            </section>

            <!-- Additional Information -->
            <section class="card-container px-6 py-6 pb-1">
              <header class="flex items-center gap-3">
                <div class="size-11 rounded-lg flex items-center justify-center bg-orange-200 dark:bg-orange-900/30">
                  <mf-icon name="solar:document-text-line-duotone" />
                </div>
                <div class="font-semibold">Additional Information</div>
              </header>

              <div class="mt-8 grid grid-cols-1 gap-4">
                <mat-form-field class="w-full">
                  <mat-label>Notes</mat-label>
                  <textarea
                    matInput
                    formControlName="notes"
                    placeholder="Optional"
                    rows="3"
                  ></textarea>
                </mat-form-field>
              </div>
            </section>
          </form>
        </div>
    </mf-overlay-scrollbar>
  </mf-panel-body>
</mf-panel>
