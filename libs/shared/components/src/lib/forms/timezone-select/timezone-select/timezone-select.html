<mat-select #select="matSelect"
            panelClass="mf-timezone-select-panel"
            [value]="_value"
            [aria-describedby]="userAriaDescribedBy"
            [disabled]="disabled"
            [placeholder]="_placeholder()"
            (opened)="onSelectOpened()"
            (closed)="onSelectClosed()">
  <div class="px-3 py-3 rounded-t sticky top-0 z-10 bg-base-100">
    <input #searchInput
           type="text" placeholder="Search..." autocomplete="off" [(ngModel)]="searchTerm"
           class="w-full input input-bordered input-sm focus:input-primary">
    @if (searchTerm().trim()) {
      <div class="absolute end-4 top-1/2 -translate-y-1/2">
        <button
          (click)="clearSearch()"
          class="btn btn-ghost btn-sm btn-circle"
          type="button"
          aria-label="Clear search">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
    }
  </div>
  @for (timezoneGroup of timezoneGroups() | filterTimezones:searchTerm(); track timezoneGroup.name) {
    <div class="px-4 font-bold text-base-content opacity-70 my-4" i18n>{{ timezoneGroup.name }}</div>
    <div>
      @for (timezone of timezoneGroup.timezones; track timezone) {
        <mat-option [value]="timezone.id" (click)="onModelChange(timezone.id)">
          {{ timezone.id }}
        </mat-option>
      }
    </div>
  } @empty {
    @if (searchTerm()) {
      <div class="text-sm px-4 py-3 text-base-content opacity-60">
        <span i18n>Timezone not found</span>.
      </div>
    }
  }
</mat-select>
