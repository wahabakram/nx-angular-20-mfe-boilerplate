<form [formGroup]="invoiceForm" class="flex flex-col gap-10">
<!--  <section class="grid grid-cols-1 md:grid-cols-2 gap-10">-->
<!--    <-upload-area class="w-72">-->
<!--      Drag logo here or click to upload-->
<!--    </-upload-area>-->
<!--    <div class="text-3xl font-bold uppercase flex items-center justify-end">-->
<!--      {{ invoiceForm.value['invoiceNumber'] }} Invoice-->
<!--    </div>-->
<!--    <div class="bg-surface-container-low px-7 py-12 rounded-2xl flex flex-col items-center justify-center gap-5">-->
<!--      <div class="font-semibold">Your company details</div>-->
<!--      <app-company-select triggerText="Add your company details"-->
<!--                          createNewText="Add your company details"-->
<!--                          emptyText="There are no you companies yet."-->
<!--                          (companyCreateNew)="addCustomerDetails()"/>-->
<!--    </div>-->
<!--    <div class="bg-surface-container-low px-7 py-12 rounded-2xl flex flex-col items-center justify-center gap-5">-->
<!--      <div class="font-semibold">Your Customer Details</div>-->
<!--      <app-company-select triggerText="Add your customer details"-->
<!--                          createNewText="Create new customer"-->
<!--                          emptyText="There are no customers yet."-->
<!--                          (companyCreateNew)="addCustomerDetails()"/>-->
<!--    </div>-->
<!--  </section>-->

<!--  <div class="p-7 border broder-default rounded-2xl mt-12">-->
<!--    <section class="grid grid-cols-1 gap-5">-->
<!--      <mat-form-field class="w-full">-->
<!--        <mat-label>Invoice number</mat-label>-->
<!--        <input matInput formControlName="invoiceNumber" />-->
<!--      </mat-form-field>-->
<!--    </section>-->
<!--    <section class="grid grid-cols-1 md:grid-cols-3 gap-5 mt-2">-->
<!--      <mat-form-field  class="w-full">-->
<!--        <mat-label>Currency</mat-label>-->
<!--        <-currency-select formControlName="currency"></-currency-select>-->
<!--      </mat-form-field>-->
<!--      <mat-form-field  class="w-full">-->
<!--        <mat-label>Invoice date</mat-label>-->
<!--        <input matInput [matDatepicker]="invoicePicker" formControlName="invoiceDate" />-->
<!--        <mat-datepicker-toggle matSuffix [for]="invoicePicker"></mat-datepicker-toggle>-->
<!--        <mat-datepicker #invoicePicker></mat-datepicker>-->
<!--      </mat-form-field>-->
<!--      <mat-form-field  class="w-full">-->
<!--        <mat-label>Due date</mat-label>-->
<!--        <input matInput [matDatepicker]="duePicker" formControlName="dueDate" />-->
<!--        <mat-datepicker-toggle matSuffix [for]="duePicker"></mat-datepicker-toggle>-->
<!--        <mat-datepicker #duePicker></mat-datepicker>-->
<!--      </mat-form-field>-->
<!--    </section>-->
<!--    <mat-form-field class="w-full mt-2 notes-field">-->
<!--      <mat-label>Notes / payment terms</mat-label>-->
<!--      <textarea matInput formControlName="paymentTerms" cdkTextareaAutosize cdkAutosizeMinRows="4"></textarea>-->
<!--    </mat-form-field>-->
<!--  </div>-->

<!--  <section class="mt-12">-->
<!--    <div class="space-y-4">-->
<!--      <div class="flex justify-between items-center">-->
<!--        <span class="text-neutral-600">Subtotal:</span>-->
<!--        <span class="font-medium uppercase">{{ subtotal() | currency: currency():'symbol' }}</span>-->
<!--      </div>-->
<!--      <mat-divider/>-->
<!--      <div class="flex justify-between font-bold mt-4 text-lg">-->
<!--        <span>Total:</span>-->
<!--        <span class="uppercase">{{ total() | currency: currency() }}</span>-->
<!--      </div>-->
<!--    </div>-->
<!--  </section>-->

  <section class="card-container px-6 py-6 pb-1">
    <header class="flex items-center gap-3">
      <div class="size-11 rounded-lg flex items-center justify-center bg-primary-200 dark:bg-neutral-variant-900">
        <mat-icon>calendar_month</mat-icon>
      </div>
      <div class="font-semibold">Invoice Details</div>
    </header>
    <div class="mt-8 grid grid-cols gap-y-2 gap-x-5">
      <mat-form-field class="col-span-2">
        <mat-label>Invoice number</mat-label>
        <input matInput formControlName="invoiceNumber" />
      </mat-form-field>
      <mat-form-field>
        <mat-label>Invoice date</mat-label>
        <input matInput [matDatepicker]="invoicePicker" formControlName="invoiceDate" />
        <mat-datepicker-toggle matSuffix [for]="invoicePicker"></mat-datepicker-toggle>
        <mat-datepicker #invoicePicker></mat-datepicker>
      </mat-form-field>
      <mat-form-field>
        <mat-label>Due date</mat-label>
        <input matInput [matDatepicker]="duePicker" formControlName="dueDate" />
        <mat-datepicker-toggle matSuffix [for]="duePicker"></mat-datepicker-toggle>
        <mat-datepicker #duePicker></mat-datepicker>
      </mat-form-field>
    </div>
  </section>

  <section class="card-container p-6">
    <header class="flex items-center gap-3">
      <div class="size-11 rounded-lg flex items-center justify-center bg-[#E7E6D2] dark:bg-neutral-variant-900">
        <mat-icon>business_center</mat-icon>
      </div>
      <div class="font-semibold">Business Information</div>
    </header>
    <div class="mt-3">
      <mat-tab-group>
        <mat-tab>
          <ng-template mat-tab-label>
            <mat-icon class="me-2">domain</mat-icon>
            Your Company
          </ng-template>
          <div class="pt-6" [formGroup]="invoiceForm.controls.company">
            <mat-form-field class="w-full">
              <mat-label>Company Name</mat-label>
              <input matInput formControlName="name" placeholder="Your Company Name LLC" />
            </mat-form-field>
            <mat-form-field class="w-full">
              <mat-label>Email</mat-label>
              <input matInput formControlName="email" placeholder="Email Address" />
            </mat-form-field>
            <mat-form-field class="w-full">
              <mat-label>Address & Contact Info</mat-label>
              <textarea matInput cdkTextareaAutosize formControlName="address" rows="3"></textarea>
            </mat-form-field>
          </div>
        </mat-tab>
        <mat-tab>
          <ng-template mat-tab-label>
            <mat-icon class="me-1">person</mat-icon>
            Client
          </ng-template>
          <div class="pt-6" [formGroup]="invoiceForm.controls.client">
            <mat-form-field class="w-full">
              <mat-label>Client Name</mat-label>
              <input matInput formControlName="name" placeholder="Acme Comropation" />
            </mat-form-field>
            <mat-form-field class="w-full">
              <mat-label>Email</mat-label>
              <input matInput formControlName="email" placeholder="Email Address" />
            </mat-form-field>
            <mat-form-field class="w-full">
              <mat-label>Address & Contact Info</mat-label>
              <textarea matInput cdkTextareaAutosize formControlName="address" rows="3"></textarea>
            </mat-form-field>
          </div>
        </mat-tab>
      </mat-tab-group>
    </div>
  </section>

  <section class="card-container p-6">
    <header class="flex items-center gap-3">
      <div class="size-11 rounded-lg flex items-center justify-center bg-[#EBE0ED] dark:bg-neutral-variant-900">
        <mat-icon>receipt_long</mat-icon>
      </div>
      <div class="font-semibold">Project & Financial Overview</div>
    </header>
    <div class="mt-6">
      <div [formGroup]="invoiceForm.controls.project">
        <div class="flex items-center justify-between">
          <div class="font-semibold">Project Information</div>
          <mat-slide-toggle formControlName="showOnInvoice">Show on invoice</mat-slide-toggle>
        </div>

        @if (!invoiceForm.controls.project.value.showOnInvoice) {
          <mf-alert variant="notice" class="mt-4">
            <mat-icon mfAlertIcon class="filled">info</mat-icon>
            This project will not be shown on the invoice.
          </mf-alert>
        }

        <div class="mt-5">
          <mat-form-field class="w-full">
            <mat-label>Project name</mat-label>
            <input matInput formControlName="name" />
          </mat-form-field>
          <mat-form-field class="w-full">
            <mat-label>Project description</mat-label>
            <textarea matInput cdkTextareaAutosize formControlName="description"></textarea>
          </mat-form-field>
        </div>
      </div>

      <div class="mt-5">
        <div class="font-semibold">Services & Items</div>
        <section class="bg-primary-100 dark:bg-neutral-variant-900 p-4 md:p-5 mt-5 rounded-3xl">
          <div formArrayName="items" class="mt-0.5 space-y-4">
            @for (item of itemsArray.controls; track $index) {
              <div [formGroupName]="$index" class="flex items-start gap-5">
                <div class="grid grid-cols-3 gap-x-5 gap-y-2">
                  <mat-form-field class="col-span-3">
                    <mat-label>Item description</mat-label>
                    <input matInput formControlName="description" />
                  </mat-form-field>
                  <mat-form-field class="col-span-1">
                    <mat-label>Quantity</mat-label>
                    <input matInput type="number" formControlName="quantity" />
                  </mat-form-field>
                  <mat-form-field class="col-span-1">
                    <mat-label>Price</mat-label>
                    <input matInput type="number" formControlName="unitCost" />
                  </mat-form-field>
                  <mat-form-field class="col-span-1">
                    <mat-label>Discount</mat-label>
                    <span matPrefix class="ps-3">{{ currencySymbol() }}</span>
                    <input matInput type="number" formControlName="discount" />
                  </mat-form-field>
                  <div class="col-span-3">
                    <div class="flex items-center justify-between gap-4">
                      <div>&nbsp;</div>
                      <div class="flex items-center gap-4">
                        <div class="font-semibold text-right uppercase">
                          {{ calculateItemAmount($index) | currency: currency() }}
                        </div>
                        <button type="button" mat-icon-button
                                [disabled]="itemsArray.length === 1"
                                (click)="removeItem($index)">
                          <mat-icon>delete_outline</mat-icon>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              @if (!$last) {
                <mf-h-divider class="mb-10"/>
              }
            }
          </div>
          <button type="button" mat-flat-button (click)="addItem()" class="mt-4">Add item</button>
        </section>
      </div>
    </div>
  </section>

  <section class="card-container p-6">
    <header class="flex items-center gap-3">
      <div class="size-11 rounded-lg flex items-center justify-center bg-[#F1F0F2] dark:bg-neutral-variant-900">
        <mat-icon>paid</mat-icon>
      </div>
      <div class="font-semibold">Invoice Summary</div>
    </header>
    <div class="mt-8">
      <mat-form-field class="w-full">
        <mat-label>Additional Notes</mat-label>
        <textarea matInput cdkTextareaAutosize rows="3" formControlName="notes"></textarea>
      </mat-form-field>
      <mat-form-field class="w-full">
        <mat-label>Tax %</mat-label>
        <input matInput formControlName="tax"/>
      </mat-form-field>
    </div>
    <div class="flex flex-col gap-4 mt-4">
      <div>
        <div class="flex justify-between items-center">
          <span class="text-neutral-600">Subtotal:</span>
          <span class="font-medium uppercase">{{ subtotal() | currency: currency():'symbol' }}</span>
        </div>
        <div class="flex justify-between items-center mt-3">
          <span class="text-neutral-600">Tax:</span>
          <span class="font-medium uppercase">{{ taxTotal() | currency: currency():'symbol' }}</span>
        </div>
      </div>
      <mat-divider/>
      <div class="flex justify-between font-bold text-lg">
        <span>Total:</span>
        <span class="uppercase">{{ total() | currency: currency() }}</span>
      </div>
    </div>
  </section>
</form>
